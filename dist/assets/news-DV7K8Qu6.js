import{v as n}from"./index-D6XfGlWg.js";import{a as i}from"./index-C0Zqfgkc.js";import{a as r}from"./api-CqIw8Mru.js";const h=n("news",{state:()=>({newsList:[],newsDetail:{},categories:[],currentCategory:1,loading:!1,refreshing:!1,finished:!1,categoriesLoading:!1}),actions:{async getCategories(){if(!this.categoriesLoading){this.categoriesLoading=!0;try{const e=await i.get(`${r.baseURL}/api/news/categories`);e.data&&e.data.code===200&&(this.categories=[...e.data.data,{id:10,name:"更多"}],!this.currentCategory&&this.categories.length>0&&(this.currentCategory=this.categories[0].id))}catch(e){console.error("获取新闻分类失败:",e),this.categories=[{id:1,name:"头条"},{id:2,name:"社会"},{id:3,name:"国内"},{id:4,name:"国际"},{id:5,name:"娱乐"},{id:6,name:"体育"},{id:7,name:"科技"}]}finally{this.categoriesLoading=!1}}},changeCategory(e){this.currentCategory=e,this.newsList=[],this.finished=!1,this.getNewsList()},async getNewsList(e=!1){e&&(this.refreshing=!0,this.newsList=[],this.finished=!1),this.loading=!0;try{const t={categoryId:this.currentCategory,page:e?1:Math.ceil(this.newsList.length/10)+1,pageSize:10},s=await i.get(`${r.baseURL}/api/news/list`,{params:t});if(s.data&&s.data.code===200){const a=s.data.data.list;this.newsList=e?a:[...this.newsList,...a],a.length<t.pageSize&&(this.finished=!0)}}catch(t){console.error("获取新闻列表失败:",t)}finally{this.loading=!1,this.refreshing=!1}},async getNewsDetail(e){try{console.log("使用模拟新闻详情数据");const t=await i.get(`${r.baseURL}/api/news/detail?id=${e}`);if(t.data&&t.data.code===200){this.newsDetail=t.data.data;return}else console.error("获取新闻详情失败: 接口返回错误")}catch(t){console.error("获取新闻详情失败:",t)}},changeCategory(e){this.currentCategory!==e&&(this.currentCategory=e,this.newsList=[],this.finished=!1,this.getNewsList(!0))},getCategoryName(e){const t=this.categories.find(s=>s.id===e);return t?t.name:"未知"}}});export{h as u};

import{u as B,o as l,c as f,b as n,t as d,f as F,g as T,h as x,i as H,a as r,d as O,w as p,F as L,j as $,e as I,r as c,k as P,l as z,m as A,n as N,p as i}from"./index-D6XfGlWg.js";import{u as G}from"./news-DV7K8Qu6.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as J}from"./TabBar-BbM-GUR-.js";import"./index-C0Zqfgkc.js";import"./api-CqIw8Mru.js";const K={class:"news-content"},Q={class:"news-title"},W={class:"news-desc"},X={class:"news-info"},Y={class:"news-image"},Z=["src","alt"],ee={__name:"NewsItem",props:{news:{type:Object,required:!0}},setup(o){const e=o,w=B(),h=()=>{w.push(`/news/detail/${e.news.id}`)};return(C,u)=>(l(),f("div",{class:"news-item",onClick:h},[n("div",K,[n("h3",Q,d(o.news.title),1),n("p",W,d(o.news.description),1),n("div",X,[n("span",null,d(o.news.author),1),n("span",null,d(o.news.publishTime),1),n("span",null,d(o.news.views)+" 阅读",1)])]),n("div",Y,[n("img",{src:o.news.image,alt:o.news.title},null,8,Z)])]))}},te=V(ee,[["__scopeId","data-v-deb1e557"]]),se={class:"home"},ne={class:"more-options"},oe={class:"category-tabs"},ae={__name:"Home",setup(o){z(t=>({v3e80dcd0:k.value+"px"}));const e=G(),w=B(),h=A(),{t:C}=F(),u=I(0),k=I(0);T(()=>h.query.categoryId,t=>{if(t){const s=parseInt(t),_=e.categories.filter(g=>g.name!=="更多").findIndex(g=>g.id===s);_!==-1&&(u.value=_,e.changeCategory(s))}},{immediate:!0}),x(()=>{e.getCategories().then(()=>{e.getNewsList()}),setTimeout(b,300),window.addEventListener("scroll",y)});const E=P(()=>e.categories.filter(t=>t.name!=="更多")),R=t=>{const m={头条:"headline",社会:"society",国内:"domestic",国际:"international",娱乐:"entertainment",体育:"sports",军事:"military",科技:"technology",财经:"finance",更多:"more"}[t];return m?C(`home.categories.${m}`):t},S=()=>{w.push("/category")},b=()=>{const t=document.querySelector(".van-tabs__wrap");t&&(k.value=t.getBoundingClientRect().top)},y=()=>{b()};x(()=>{e.getNewsList(),setTimeout(b,300),window.addEventListener("scroll",y)}),H(()=>{window.removeEventListener("scroll",y)}),T(u,t=>{const s=e.categories[t].id;e.changeCategory(s)});const M=()=>{e.getNewsList(!0)},U=()=>{e.getNewsList()};return(t,s)=>{const m=c("van-nav-bar"),_=c("van-icon"),g=c("van-list"),q=c("van-pull-refresh"),j=c("van-tab"),D=c("van-tabs");return l(),f("div",se,[r(m,{title:t.$t("home.title"),fixed:""},null,8,["title"]),n("div",ne,[n("div",{class:"more-tab",onClick:S},[O(d(t.$t("home.more"))+" ",1),r(_,{name:"arrow"})])]),n("div",oe,[r(D,{active:u.value,"onUpdate:active":s[2]||(s[2]=v=>u.value=v),sticky:"",swipeable:"",animated:""},{default:p(()=>[(l(!0),f(L,null,$(E.value,(v,ie)=>(l(),N(j,{key:v.id,title:R(v.name),onClick:a=>i(e).changeCategory(v.id)},{default:p(()=>[r(q,{modelValue:i(e).refreshing,"onUpdate:modelValue":s[1]||(s[1]=a=>i(e).refreshing=a),onRefresh:M},{default:p(()=>[r(g,{loading:i(e).loading,"onUpdate:loading":s[0]||(s[0]=a=>i(e).loading=a),finished:i(e).finished,"finished-text":t.$t("home.noMore"),onLoad:U},{default:p(()=>[(l(!0),f(L,null,$(i(e).newsList,a=>(l(),N(te,{key:a.id,news:a},null,8,["news"]))),128))]),_:1},8,["loading","finished","finished-text"])]),_:1},8,["modelValue"])]),_:1},8,["title","onClick"]))),128))]),_:1},8,["active"])]),r(J)])}}},ge=V(ae,[["__scopeId","data-v-9bc6af8c"]]);export{ge as default};

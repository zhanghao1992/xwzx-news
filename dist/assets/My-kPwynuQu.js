import{u as N}from"./user-bSK34LHc.js";import{f as V,h as D,c as m,a as t,b as e,t as c,s as v,w as g,d as h,n as M,r as i,k as p,u as R,o as u}from"./index-D6XfGlWg.js";import{T as U}from"./TabBar-BbM-GUR-.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{s as f}from"./function-call-DfxdXIrz.js";import{s as F}from"./function-call-DjmNWhop.js";import"./index-C0Zqfgkc.js";import"./api-CqIw8Mru.js";import"./mount-component-CAUN_HIz.js";const H={class:"my-container"},E={class:"avatar"},P={class:"info"},q={class:"username"},A={key:0,class:"desc"},G={key:1,class:"user-info"},J={class:"avatar"},K={class:"info"},O={class:"username"},Q={class:"desc"},W={class:"menu-list"},X={__name:"My",setup(Y){const a=N(),s=R(),{t:l}=V(),y=p(()=>a.userInfo),n=p(()=>a.getLoginStatus),k=p(()=>a.getUserBio||l("profile.bio")),T=()=>{s.push("/login")},w=()=>{s.push("/register")},C=()=>{n.value&&s.push("/profile")},$=()=>{n.value?s.push("/history"):(f(l("common.login")),s.push("/login"))},b=()=>{n.value?s.push("/favorite"):(f(l("common.login")),s.push("/login"))},B=()=>{s.push("/settings")},I=()=>{F({title:l("common.confirm"),message:l("my.logout")+"?",showCancelButton:!0}).then(o=>{o==="confirm"&&(a.logout(),s.push("/login"))})};return D(async()=>{try{await a.getUserInfoDetail()}catch(o){console.error("获取用户信息失败:",o)}}),(o,Z)=>{const L=i("van-nav-bar"),d=i("van-image"),S=i("van-icon"),_=i("van-button"),r=i("van-cell"),j=i("van-cell-group");return u(),m("div",H,[t(L,{title:o.$t("my.title")},null,8,["title"]),n.value?(u(),m("div",{key:0,class:"user-info",onClick:C},[e("div",E,[t(d,{round:"",width:"80",height:"80",src:"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"})]),e("div",P,[e("div",q,c(n.value?y.value.username:o.$t("my.notLoggedIn")),1),n.value?(u(),m("div",A,c(k.value||o.$t("profile.bio")),1)):v("",!0)]),t(S,{name:"arrow",class:"arrow-icon"})])):(u(),m("div",G,[e("div",J,[t(d,{round:"",width:"80",height:"80",src:"https://fastly.jsdelivr.net/npm/@vant/assets/cat.jpeg"})]),e("div",K,[e("div",O,c(o.$t("my.notLoggedIn")),1),e("div",Q,[t(_,{type:"primary",size:"small",onClick:T,style:{"margin-right":"10px"}},{default:g(()=>[h(c(o.$t("my.goToLogin")),1)]),_:1}),t(_,{type:"default",size:"small",onClick:w},{default:g(()=>[h(c(o.$t("my.goToRegister")),1)]),_:1})])])])),e("div",W,[t(j,{inset:""},{default:g(()=>[t(r,{title:o.$t("my.myFavorite"),"is-link":"",onClick:b},null,8,["title"]),t(r,{title:o.$t("my.browsingHistory"),"is-link":"",onClick:$},null,8,["title"]),t(r,{title:o.$t("my.notifications"),"is-link":""},null,8,["title"]),t(r,{title:o.$t("my.settings"),"is-link":"",onClick:B},null,8,["title"]),n.value?(u(),M(r,{key:0,title:o.$t("my.logout"),onClick:I},null,8,["title"])):v("",!0)]),_:1})]),t(U)])}}},ro=z(X,[["__scopeId","data-v-1e46cfb6"]]);export{ro as default};
